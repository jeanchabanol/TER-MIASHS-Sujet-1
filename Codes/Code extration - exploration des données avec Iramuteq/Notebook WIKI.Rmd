---
title: "Extraction des biographies wikipédia"
output: html_notebook
---

Import des librairies utiles.

```{r}
library(data.table)
library(stringr)
```

Import des jeux de données.

```{r}
#Dossier contenant les jeux de données wiki
setwd("C:/Users/celia/Downloads/")
#Suicides
dt_suicides=fread("List_of_suicides.csv", sep = ",", header=T, encoding = "UTF-8")

#Artistes écrivains
dt_ecrivains=fread("Artist_authors.csv", sep = ",", header=T, encoding = "UTF-8")

#Artistes politiques
dt_artistes=fread("Political_artists.csv", sep = ",", header=T, encoding = "UTF-8")

#Acteurs américains
dt_acteurs=fread("American_film_actors.csv", sep = ",", header=T, encoding = "UTF-8")

#Actrices américaines
dt_actrices=fread("American_film_actresses.csv", sep = ",", header=T, encoding = "UTF-8")
```

Mise en forme des jeux.
```{r}
#Jeu complet excepté suicide
dt_non_suicides=rbind(dt_ecrivains,dt_artistes,dt_acteurs,dt_actrices)
#On enlève les lignes sans bio
dt_suicides=dt_suicides[content!="no_matching_content",]
dt_non_suicides=dt_non_suicides[content!="no_matching_content",]

#On enlève les personnes suicidées de la liste des bio des personnes non suicidées
dt_non_suicides=dt_non_suicides[!pages_names %in% unique(dt_suicides[,pages_names]),]

#On enlève les doublons
dt_suicides=dt_suicides[,.SD[1], by=content]
dt_non_suicides=dt_non_suicides[,.SD[1], by=content]
#Ajout catégorie suicide
dt_suicides[,suicide:=T]
dt_non_suicides[,suicide:=F]


#On lie les 2
dt_total=rbind(dt_suicides,dt_non_suicides)
```


Export du jeu de données
```{r}
#Emplacement de l'enreistrement
setwd("C:/Users/celia/Documents/MIASHS/M1/terbis/")
#Enregistrement
write.csv(dt_total,"C:/Users/celia/Documents/MIASHS/M1/terbis/donnees_wiki_total.csv",row.names = FALSE)
```


#######################################################################################################

#######################################################################################################

# Visualisation de données

#Suicides

```{r}
#On enlève les colonnes inutiles
dt_suicides_v=dt_suicides[,.(pages_names, subcategory, content)]

#On rend le jeu lisible par iramuteq
dt_suicides_v=dt_suicides_v[, sep_text:="****"][, subcategory:=paste("*cat_",subcategory,sep="")][, pages_names:=paste("*page_",pages_names, sep="")][,content:=paste("\n",content, sep="")][,content:=iconv(content,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,pages_names:=iconv(pages_names,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,subcategory:=iconv(subcategory,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,.(sep_text, pages_names, subcategory, content)]

#On transforme les expressions
dt_suicides_v=dt_suicides_v[,content:=str_replace_all(content,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_", "\\(_\\)"=""))]
dt_suicides_v=dt_suicides_v[,pages_names:=str_replace_all(pages_names,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]
dt_suicides_v=dt_suicides_v[,subcategory:=str_replace_all(subcategory,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]

```

On exporte le jeu utilisable sur iramuteq.


```{r}
fwrite(dt_suicides_v, "C:/Users/celia/Documents/MIASHS/M1/terbis/Wiki/Iramuteq/Suicide/wiki_ts.txt", sep = " ", quote=F)
```


#Pas suicides

```{r}
#On enlève les colonnes inutiles
dt_non_suicides_v=dt_non_suicides[,.(pages_names, subcategory, content)]

#On rend le jeu lisible par iramuteq
dt_non_suicides_v=dt_non_suicides_v[, sep_text:="****"][, subcategory:=paste("*cat_",subcategory,sep="")][, pages_names:=paste("*page_",pages_names, sep="")][,content:=paste("\n",content, sep="")][,content:=iconv(content,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,pages_names:=iconv(pages_names,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,subcategory:=iconv(subcategory,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,.(sep_text, pages_names, subcategory, content)]

#On transforme les expressions
dt_non_suicides_v=dt_non_suicides_v[,content:=str_replace_all(content,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_", "\\(_\\)"=""))]
dt_non_suicides_v=dt_non_suicides_v[,pages_names:=str_replace_all(pages_names,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]
dt_non_suicides_v=dt_non_suicides_v[,subcategory:=str_replace_all(subcategory,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]

```

On exporte le jeu utilisable sur iramuteq.


```{r}
fwrite(dt_non_suicides_v, "C:/Users/celia/Documents/MIASHS/M1/terbis/Wiki/Iramuteq/Non_suicide/wiki_pas_ts.txt", sep = " ", quote=F)
```




#######################################################################################################

#######################################################################################################

# Visualisation de données

#Suicides

```{r}
#On enlève les colonnes inutiles
dt_suicides_v=dt_suicides[,.(pages_names, subcategory, content)]

#On rend le jeu lisible par iramuteq
dt_suicides_v=dt_suicides_v[, sep_text:="****"][, subcategory:=paste("*cat_",subcategory,sep="")][, pages_names:=paste("*page_",pages_names, sep="")][,content:=paste("\n",content, sep="")][,content:=iconv(content,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,pages_names:=iconv(pages_names,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,subcategory:=iconv(subcategory,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,.(sep_text, pages_names, subcategory, content)]

#On transforme les expressions
dt_suicides_v=dt_suicides_v[,content:=str_replace_all(content,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_", "\\(_\\)"=""))]
dt_suicides_v=dt_suicides_v[,pages_names:=str_replace_all(pages_names,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]
dt_suicides_v=dt_suicides_v[,subcategory:=str_replace_all(subcategory,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]

```

On exporte le jeu utilisable sur iramuteq.


```{r}
fwrite(dt_suicides_v, "C:/Users/celia/Documents/MIASHS/M1/terbis/Wiki/Iramuteq/Suicide/wiki_ts.txt", sep = " ", quote=F)
```


#Pas suicides

```{r}
#On enlève les colonnes inutiles
dt_non_suicides_v=dt_non_suicides[,.(pages_names, subcategory, content)]

#On rend le jeu lisible par iramuteq
dt_non_suicides_v=dt_non_suicides_v[, sep_text:="****"][, subcategory:=paste("*cat_",subcategory,sep="")][, pages_names:=paste("*page_",pages_names, sep="")][,content:=paste("\n",content, sep="")][,content:=iconv(content,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,pages_names:=iconv(pages_names,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,subcategory:=iconv(subcategory,from = 'UTF-8', to = 'ASCII//TRANSLIT')][,.(sep_text, pages_names, subcategory, content)]

#On transforme les expressions
dt_non_suicides_v=dt_non_suicides_v[,content:=str_replace_all(content,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_", "\\(_\\)"=""))]
dt_non_suicides_v=dt_non_suicides_v[,pages_names:=str_replace_all(pages_names,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]
dt_non_suicides_v=dt_non_suicides_v[,subcategory:=str_replace_all(subcategory,c("[:digit:]"=""," & "="_and_","-year"="year", "-mid"="mid","-"="_", "year old"="year_old","'"=" ","Washington ,  D . C ."="Washington_DC", "Washington,_D.C"="Washington_DC", "New York City"="New_York_City","New York"="New_York","\n( *)"="\n", "([:space:]*[.][:space:]*)"=". ","([:space:]*[,][:space:]*)"=", ","([:space:]*[;][:space:]*)"=" ; ","([:space:]*[:][:space:]*)"=" : ","\"\""="\"","Madame d Angoulême"="Madame_d_Angoulême", "St. "="St_"))]

```

On exporte le jeu utilisable sur iramuteq.


```{r}
fwrite(dt_non_suicides_v, "C:/Users/celia/Documents/MIASHS/M1/terbis/Wiki/Iramuteq/Non_suicide/wiki_pas_ts.txt", sep = " ", quote=F)
```


















